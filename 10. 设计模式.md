## IX. 系统架构与中间件实践

### A. 架构设计原则与模式

##### 1. 常见的架构设计原则有哪些？ ★★★☆☆

##### 2. 架构设计中最重要的三个要素是什么？ ★★★☆☆

##### 3. 什么是技术债务？你如何理解它？ ★★★☆☆

##### 4. 架构是设计出来的还是演进出来的？ ★★★☆☆

##### 5. 什么样的架构才算好的架构？ ★★★☆☆

##### 6. 为什么说做架构其实就是做权衡？ ★★★☆☆

##### 7. 微服务的拆分有哪些原则？ ★★★☆☆

##### 8. 什么是单元化架构？ ★★☆☆☆

##### 9. 什么是银弹，什么叫没有银弹？ ★☆☆☆☆

##### 10. MVC和三层架构有什么区别？ ★★★☆☆

##### 11. 你认为分布式架构一定比单体架构要好吗？ ★★★☆☆

##### 12. 如何做技术选型？ ★★★☆☆

### B. 高并发与高可用实践

##### 1. 如何设计一个能够支持高并发的系统？ ★★★★★

##### 2. 如何设计一个高可用架构？ ★★★★★

##### 3. 如何设计一个高性能的分布式系统？ ★★★★★

##### 4. 什么是QPS，什么是RT？说下什么是p90, p95, p99？ ★★★★☆

##### 5. 服务端接口性能优化有哪些方案？ ★★★★☆

##### 6. 读写分离遇到主从延迟怎么办？ ★★★★☆

##### 7. 什么是SLA？ ★★☆☆☆

##### 8. 什么是冷备、热备、暖备？ ★★☆☆☆

##### 9. 什么是异地多活？ ★★★★☆

##### 10. 高并发场景中，乐观锁和悲观锁哪个更适合？ ★★★★☆

### C. 缓存优化实践

##### 1. 在高并发读场景下，如何设计并实现一个本地缓存来减轻数据库压力？你会考虑使用哪些本地缓存框架？ ★★★★☆

##### 2. 你的系统面临响应时间瓶颈，数据访问链路较长，你会如何设计一个多级缓存体系来提升整体性能？ ★★★★☆

##### 3. 当你的系统引入本地缓存后，如何确保缓存数据与数据库数据保持最终一致性？请描述具体方案。 ★★★★☆

##### 4. 在设计一个针对电商商品详情页的缓存方案时，你会从哪些方面进行考量和决策？（例如：数据特点、访问模式、一致性要求、容量规划等） ★★★★★

### D. 消息队列实践

##### 1. 为什么不建议使用MQ实现订单到期关闭？ ★★★☆☆

##### 2. 为什么不直接用原生BlockinQueue做消息队列？ ★★★☆☆

##### 3. 为了避免丢消息需要落表，如何设计这张消息表？ ★★★★☆

### E. 性能测试与压测

##### 1. 什么是压测？怎么做压测？ ★★★★☆

##### 2. 什么是全链路压测？ ★★★★☆

##### 3. 压测如何避免影响线上用户？ ★★★☆☆

##### 4. 单机压测到300QPS，10台就能抗住3000QPS吗？ ★★★☆☆

##### 5. 压测600没问题，上线后300就扛不住了，可能是什么原因？ ★★★★☆

### F. 定时任务

##### 1. 为什么定时任务可以定时执行？ ★★★☆☆

##### 2. Java中实现定时任务的几种方式？ ★★★☆☆

##### 3. Java中Timer实现定时调度的原理是什么？ ★★★☆☆

##### 4. 什么是时间轮？ ★★★☆☆

##### 5. 实现一个定时任务，可以用什么数据结构及算法？ ★★★☆☆

##### 6. 定时任务扫表方案有什么缺点？ ★★★★☆

##### 7. xxl-job如何保证任务只会触发一次？ ★★★★☆

##### 8. xxl-job支持分片任务吗？实现原理是什么？ ★★★★☆

##### 9. 知道PowerJob吗，他和XXL-JOB有啥区别？ ★★★☆☆

##### 10. 知道MapReduce动态分片任务吗？好处是什么？原理是什么？ ★★★☆☆

##### 11. 用@Scheduled执行定时任务，如何避免集群的并发问题？ ★★★★☆

##### 12. 扫表任务，如何写SQL可以避免出现跳页的情况？ ★★★★☆

### G. 文件处理

##### 1. 什么是POI，为什么它会导致内存溢出？ ★★★★☆

##### 2. POI如何做大文件的写入？ ★★★★☆

##### 3. 为什么SXSSFWorkbook占用内存更小？ ★★★★☆

##### 4. 如何针对大Excel做文件读取？ ★★★★☆

##### 5. 读取一个千个文件，一个线程读取和开十个线程读取，哪种方式更快？ ★★★☆☆

##### 6. 如何实现百万级数据从Excel导入到数据库？ ★★★☆☆

### H. 中间件与技术选型

##### 1. 如何让你实现一个RPC框架，会考虑哪些技术解决哪些问题？ ★★★★☆

##### 2. Redis、MySQL和MongoDB的区别是什么，各自适用场景有哪些？ ★★★★☆

### I. 数据处理与存储综合

##### 1. 亿级商品如何存储？ ★★★★☆

##### 2. 40亿个QQ号，限制1G内存，如何去重？ ★★★★☆

##### 3. 应用程序占内存持续增长，但是堆内存、元空间都没变化，可能是哪些原因？ ★★★★☆

##### 4. 和其他公司做数据交互时，有什么需要注意的？ ★★★☆☆

##### 5. MySQL里有2000W数据，Redis中只存20W的数据，怎么查询最近N天有登录的用户并且查询分页要快？ ★★★★☆

##### 6. 数据库逻辑删除后，怎么做唯一性约束？ ★★★☆☆

##### 7. 为什么很多公司数据库不允许物理删除（delete）数据？ ★★★☆☆

##### 8. 不用大于号判断两个正整数大小？ ★★★☆☆

##### 9. 大量的手机号码被标记成骚扰电话，如何存储这些号码？ ★★★☆☆

##### 10. 一个表有用户和时间两个列，现在有3个需求：根据用户查，根据时间范围查，根据用户时间范围查，如何建立索引？ ★★★★☆

##### 11. 做一个过滤黑名单网址的系统，你觉得要怎么实现，会用到哪些数据结构？ ★★★★☆

##### 12. 全国酒店价格（千万级）需要在某个瞬间比如7点发生变更，如何实现？ ★★★★☆

##### 13. 如何做平滑的数据迁移？ ★★★☆☆

##### 14. 什么是数据归档，一般是怎么做的？ ★★★★☆

##### 15. 如果有1TB的数据需要排序，但只有32GB的内存如何排序处理？ ★★★★☆

##### 16. 如何从1TB的搜索日志中找出搜索量最高的10个关键词？ ★★★★☆

##### 17. 如何实现百万级会员的用户平台，如何实现快到期的会员的消息提醒功能？ ★★★★☆

### J. 场景题与综合应用

#### J.1 业务核心功能设计与实现

##### 1. 让你设计一个订单号生成服务，该怎么做？ ★★★★☆

##### 2. 订单到期关闭如何实现？ ★★★★☆

##### 3. 如何设计一个购物车功能？ ★★★★☆

##### 4. 让你设计一个秒杀系统，你会考虑哪些问题？ ★★★★★

##### 5. 库存扣减如何避免超卖和少卖？ ★★★★★

##### 6. 高并发的库存系统，在数据库扣减库存，怎么实现？ ★★★★★

##### 7. 电商下单场景，如何设计一个数据一致性方案？ ★★★★☆

##### 8. 让你实现短链服务，如何生成不重复的短链地址？ ★★★★☆

##### 9. 如何实现一个抢红包功能？ ★★★☆☆

##### 10. 如何实现敏感词过滤？ ★★★★☆

##### 11. 如何实现百万级排行榜功能？ ★★★★☆

##### 12. 如何用Redis实现朋友圈点赞功能？ ★★★☆☆

##### 13. Redis的zset实现排行榜，实现分数相同按照时间顺序排序，怎么做？ ★★★★☆

##### 14. 如何实现“查找附近的人”功能？ ★★★★☆

##### 15. 购物车中如何解决重复下单的问题？ ★★★★☆

##### 16. 秒杀场景下，怎么加库存？ ★★★★☆

##### 17. 库扣减、创建订单，如何拆成TCC？ ★★★★☆

##### 18. 百万级会员的用户平台，如何实现快到期的会员的消息提醒功能？ ★★★★☆

##### 19. 外卖系统，一天一千万条数据，用户需要查到近30天的数据？ ★★★★☆

#### J.2 分布式与高并发挑战处理

##### 1. 如果你的业务量突然提升100倍QPS你会怎么做？ ★★★★☆

##### 2. 每日100w次登录请求，4C8G机器如何做JVM调优？ ★★★★☆

##### 3. 如何预估一个系统的QPS？ ★★★★☆

##### 4. 100个优惠券，有几千万流量，怎么保证服务器不跨掉，高并发如何支持？ ★★★★☆

##### 5. 5分钟内最多允许用户尝试登录3次，如果错误次数超过限制，如何设计？ ★★★★☆

##### 6. 不用分布式锁如何防止用户重复点击？ ★★★☆☆

##### 7. 加分布式锁之后影响并发了怎么办？ ★★★☆☆

##### 8. 分库分表时，每个城市的人口不一样，有的密集，有的稀疏，如何处理？ ★★★★☆

##### 9. 大型电商的订单系统，如何设计分库分表方案？ ★★★★☆

##### 10. 如果单表数据量大，只能考虑分库分表吗？ ★★★☆☆

##### 11. 什么是数据倾斜？如何避免和解决？ ★★★★☆

##### 12. 为什么不用分布式锁来实现秒杀？ ★★★☆☆

#### J.3 数据一致性与事务处理

##### 1. 如何解决消息重复消费、重复下单等问题？ ★★★★★

##### 2. 一个订单，在11:00超时关闭，但在11:00也支付成功了，怎么办？ ★★★★☆

##### 3. 一个支付单，多个渠道同时支付成功了怎么办？ ★★★★☆

##### 4. 调用第三方接口支付时，第三方接口显示支付成功，但是在我方系统显示支付失败，该怎么处理？ ★★★★☆

##### 5. 账户里面只有十块钱，同时发来两笔订单一共大于十块钱，怎么实现？ ★★★☆☆

##### 6. 为什么不建议在事务中做外部调用？ ★★★☆☆

##### 7. 使用分布式锁时，分布式锁加在事务外面还是里面，有什么区别？ ★★★☆☆

##### 8. 数据库乐观锁和悲观锁以及Redis分布式锁的区别和使用场景？ ★★★★☆

##### 9. 用了一个锁二查三更新，为啥还出现了重复数据？ ★★★★☆

##### 10. 下单支付过程，点击跳转支付，输入密码，支付完成后跳转回商家页面，如何保证数据一致性？ ★★★★☆

##### 11. A线程获取Redis分布式锁，但那一刻做了主从的切换，B线程获取锁成功，可能发生什么？ ★★★★☆

#### J.4 故障排查与系统稳定性

##### 1. 线上接口如果响应很慢如何去排查定位问题呢？ ★★★★★

##### 2. 应用启动后前几分钟，Load、RT、CPU等飙高，如何定位，分析？ ★★★★☆

##### 3. 服务器有多个节点，线上出现用户进入缓慢，监控服务器cpu，内存，load正常，网络无异常怎么排查？ ★★★★☆

##### 4. Redis如果挂了，你怎么办？ ★★★☆☆

##### 5. Redis的内存如果用满了，会挂吗？ ★★★☆☆

##### 6. MySQL突然断电，会发生数据丢失吗？ ★★★★☆

##### 7. 假设有很多内存，有什么情况会频繁fullgc？ ★★★★☆

##### 8. 进去电梯里断网后又恢复刚开始为什么网络慢？ ★★★☆☆

##### 9. Redis和MySQL的一次普通查询，RT在什么范围是合理的？ ★★★★☆

#### J.5 数据存储与查询优化

##### 1. 如何做数据对账？ ★★★☆☆

##### 2. MySQL千万级大表如何做数据清理？ ★★★☆☆

##### 3. MySQL热点数据更新会带来哪些问题？ ★★★☆☆

##### 4. MySQL里有2000W数据，Redis中只存20W的数据，怎么查询最近N天有登录的用户并且查询分页要快？ ★★★★☆

##### 5. 如果要存IP地址，用什么数据类型比较好？ ★★★☆☆

##### 6. 一个表有用户和时间两个列，现在有3个需求：根据用户查，根据时间范围查，根据用户时间范围查，如何建立索引？ ★★★★☆

##### 7. 阿里出的Java开发手册看过吗，对哪条规印象深刻？ ★★★☆☆

##### 8. MySQL单表一千万条数据怎么做分页查询？ ★★★★☆

##### 9. MySQL千万级数据量，查询如何做优化？ ★★★★☆

##### 10. 有一张上百万条数据的单表，从前端页面、Java后台、数据库，如何优化查询？ ★★★★☆

#### J.6 外部集成与安全

##### 1. 和外部机构交互如何防止被外部服务不可用而拖垮？ ★★★★☆

##### 2. 给第三方接口调用，需要注意些什么？ ★★★☆☆

##### 3. 调用第三方接口支付时，第三方接口显示支付成功，但是在我方系统显示支付失败，该怎么处理？ ★★★★☆

##### 4. 两个不相关的网站A和B，如何实现A登录B也能自动登录？ ★★★★☆

##### 5. 分布式系统，用户登录信息保存在服务器A上，服务器B如何获取？ ★★★★☆

##### 6. 实现一个登录拉黑功能，实现拉黑用户和把已经登陆用户踢下线？ ★★★★☆

##### 7. 如果Token被窃取了，是不是就能够登陆了？ ★★★★☆

##### 8. 做一个过滤黑名单网址的系统，你觉得要怎么实现，会用到哪些数据结构？ ★★★★☆

##### 9. 防止接口被恶意刷流量，除了限流还应在代码层面做哪些防御？ ★★★★☆

#### J.7 性能调优与容量规划

##### 1. 一个接口3000QPS，接口RT为200MS，预估需要几台机器？ ★★★★☆

##### 2. 4C8G的机器，各项系统指标，什么范围是正常？ ★★★☆☆

##### 3. 4C8G *16台 和 8C16G*8台，不考虑成本的情况下怎么选？ ★★★☆☆

##### 4. 在100M内存存储一亿个整数，其范围在1到2亿，如何快速去重？ ★★★★☆

##### 5. 项目中，如果日志打印成为瓶颈，该如何优化？ ★★★☆☆

##### 6. 如何从1TB的搜索日志中找出搜索量最高的10个关键词？ ★★★★☆

##### 7. 如果有1TB的数据需要排序，但只有32GB的内存如何排序处理？ ★★★★☆

#### J.8 其他综合场景

##### 1. 为什么不用大于号判断两个正整数大小？ ★★★☆☆

##### 2. 进去电梯里断网后又恢复刚开始为什么网络慢？ ★★★☆☆

##### 3. 项目中需要应用发布和ddl变更，需要如何保证不出错？ ★★★☆☆

##### 4. 代码中使用长事务，会带来哪些问题？ ★★★☆☆

## X. 设计模式

### A. 设计模式基础与原则

##### 1. 什么是设计模式？有什么好处？ ★★★★☆

##### 2. 设计模式的7大基本原则有哪些？ ★★★★☆

##### 3. 在工作中是如何使用设计模式的？ ★★★★☆

##### 4. 使用哪种设计模式可以提高代码可维护性？ ★★★☆☆

##### 5. 使用哪种设计模式可以提高代码的复用性？ ★★★☆☆

### B. 创建型设计模式

##### 1. 单例模式的多种写法？如何破坏单例模式？为什么说枚举是实现单例最好的方式？不使用锁如何实现线程安全的单例？ ★★★★★

##### 2. 三种工厂模式的区别和特点？ ★★★★★

### C. 结构型设计模式

##### 1. 什么是不可变模式，有哪些应用？ ★★★★☆

##### 2. 什么是享元模式，有哪些具体应用？ ★★★☆☆

##### 3. String的设计，用到了哪些设计模式？ ★★★★★

##### 4. 什么是代理模式，有哪些应用？ ★★★★★

##### 5. 请简述MVC模式的思想？ ★★★★☆

### D. 行为型设计模式

##### 1. 什么是责任链模式，有哪些应用？ ★★★★☆

##### 2. 什么是状态模式，有哪些应用？ ★★★☆☆

##### 3. 策略模式和if-else相比有什么好处？ ★★★★☆

##### 4. 什么是观察者模式，有哪些应用？ ★★★★☆

##### 5. 什么是模板方法模式，有哪些应用？ ★★★☆☆

##### 6. 针对天气预报变化时触发用户通知和推荐行程用什么设计模式？ ★★★★☆